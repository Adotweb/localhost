<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="icon" href="/icons/favicon.ico">

  <script src="/js/data.js"></script>
  
  <script src="/js/components/navbar.js" defer></script>

  <script src="./account.js"></script>

</head>

<script async>
	
	let usersesh = $get("user-session"); 


	if(!usersesh) {
		window.location.replace(window.location.origin + "/account/login.html")	
	}

	document.addEventListener("DOMContentLoaded", ( )=> {



	if($get("user").subscriptionStatus === "free"){
		document.getElementById("cancelsub").style.display = "none"
	}if($get("user").subscriptionStatus === "cancelling"){
		let el = document.getElementById("cancelsub")
			

			el.classList.add("bg-green-500");
			el.classList.remove("bg-red-600")
			el.innerHTML = "reactivate Subscription"
			
			el.onclick = () => window.location.href = "/products/checkout"
	}

	if($get("user").projects.length > 0){
		
		let projects = document.getElementById("projects")
	
	getProjects().then(res => {



res.p.forEach(project => {
		
			let {projectName, app_id, api_key} = project

			let card = `<div  class="rounded-md border-2 border-gray-500 drop-shadow-xl m-2 p-4 w-[90%] h-[90%] flex flex-col items-center text-lg">
			<div class="w-full">Project Name : ${projectName}</div>
			<div class="w-full">app_id : <p>${app_id}</p></div>
			<div class="w-full">api_id: <p>${api_key}</p></div>

	

			</div>`

			
			projects.innerHTML += card

		})


});

		
	}

})
	
</script>


<body class="m-0">
	
	<div class="navbar"></div>
	
	
	<div class="flex flex-col w-full font-bold text-2xl flex flex-col items-center">
	


			<div class="usercard rounded-md p-4 drop-shadow-xl border-2 border-gray-800 flex flex-col items-center ">
				<h1 class="text-xl">Manage Account</h1>


				<div class="text-red-500 text-lg mt-4"> Danger Zone</div>
				<div class="text-lg">
				<button onclick="logout()" class="bg-red-600 rounded-md p-2 text-white">logout</button>

				<button id="cancelsub" onclick="cancelSub()" class="bg-red-600 rounded-md p-2 text-white">cancel subscription</button>
			</div>
			</div>
				

		<h1 class="w-full my-2 p-4">
			Projects
		</h1>
		<div id="projects" class="dashboard-top w-full grid grid-cols-4 justify-center items-center">

			
			
			

			<button onclick="openProjectCreator()" class="rounded-md border-2 border-gray-500 drop-shadow-xl m-2 p-4 w-[90%] h-[90%]">
				+	
			</button>	

		</div>
	</div>	






	<div class="hidden absolute top-0 left-0 z-10 bg-[#4f4b4baf] w-full h-full flex justify-center items-center font-bold" id="projectCreator">
		<div id="closer" class="w-full h-full bg-transparent absolute top-0 left-0 "></div>
		<div class="bg-white rounded-md p-4 z-11 relative flex flex-col">
		
			<label for="projectname">Projectname</label>
			<input class="border-b-2 border-black outline-none" type="text" id="projectName" placeholder="projectname">
		
			<button onclick="createProject()" class="rounded-md bg-indigo-400 p-2 mt-4">
				Create
			</button>			

		</div>
	</div>
</body>
